(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{738:(e,t,n)=>{Promise.resolve().then(n.bind(n,2915))},2915:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>X});var l=n(5155),o=n(2115),r=n(9552),i=n(5417),a=n(979),s=n(2282),c=n(8998),u=n(8871),h=n(4490),d=n(8562),x=n(5565),p=n(8334),g=n.n(p);function f(e){let{piece:t,onPointerDown:n,onContextMenu:o,onResizeEdgePointerDown:r}=e,{id:i,type:a,src:s,color:c,width:u,height:h,top:d,left:p}=t;return(0,l.jsxs)("div",{className:g().mosaicPiece,style:{width:u,height:h,top:d,left:p},onPointerDown:e=>n(e,i),onContextMenu:e=>o(e,i),children:["color"===a?(0,l.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:c}}):s&&(0,l.jsx)(x.default,{src:s,alt:"mosaic-piece",width:u,height:h,style:{objectFit:"cover"}}),(0,l.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"6px",cursor:"row-resize"},onPointerDown:e=>r(e,i,"top")}),(0,l.jsx)("div",{style:{position:"absolute",bottom:0,left:0,width:"100%",height:"6px",cursor:"row-resize"},onPointerDown:e=>r(e,i,"bottom")}),(0,l.jsx)("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"6px",cursor:"col-resize"},onPointerDown:e=>r(e,i,"left")}),(0,l.jsx)("div",{style:{position:"absolute",top:0,right:0,height:"100%",width:"6px",cursor:"col-resize"},onPointerDown:e=>r(e,i,"right")}),(0,l.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"10px",height:"10px",cursor:"nwse-resize"},onPointerDown:e=>r(e,i,"top-left")}),(0,l.jsx)("div",{style:{position:"absolute",top:0,right:0,width:"10px",height:"10px",cursor:"nesw-resize"},onPointerDown:e=>r(e,i,"top-right")}),(0,l.jsx)("div",{style:{position:"absolute",bottom:0,left:0,width:"10px",height:"10px",cursor:"nesw-resize"},onPointerDown:e=>r(e,i,"bottom-left")}),(0,l.jsx)("div",{style:{position:"absolute",bottom:0,right:0,width:"10px",height:"10px",cursor:"nwse-resize"},onPointerDown:e=>r(e,i,"bottom-right")})]})}function m(e){let{colorPalette:t,open:n,position:r,piece:i,onChangeColorIndex:a,onChangeImageClick:c,onDeletePiece:u,closeMenu:h}=e,d=(0,o.useRef)(null);return((0,o.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&h()};return n&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[n,h]),n&&i)?(0,l.jsxs)("div",{ref:d,style:{position:"fixed",top:r.y,left:r.x,background:"white",border:"1px solid #ccc",borderRadius:"4px",padding:"8px",zIndex:9999},onContextMenu:e=>{e.preventDefault(),e.stopPropagation()},children:["color"===i.type&&(0,l.jsx)("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:t.map((e,t)=>(0,l.jsx)("div",{style:{width:24,height:24,backgroundColor:e,cursor:"pointer",border:"1px solid #999"},onClick:()=>a(t)},"".concat(e,"-").concat(t)))}),"image"===i.type&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.A,{onClick:c,variant:"outlined",size:"small",sx:{mb:1},children:"Change Image"}),(0,l.jsx)("br",{})]}),(0,l.jsx)(s.A,{onClick:u,variant:"contained",color:"error",size:"small",children:"Delete"})]}):null}var j=n(7293),b=n(5480),y=n(6251),v=n(5674);function w(e){let{colorPalette:t,onChangeColor:n}=e,[r,i]=(0,o.useState)(null),[a,u]=(0,o.useState)(null),[h,d]=(0,o.useState)(null),x=(e,n)=>{i(e.currentTarget),u(n),d(t[n])},p=()=>{i(null),u(null),d(null)},g=()=>{let e=v.Ay.random();return[e.hex(),e.set("hsl.h","+90").hex(),e.set("hsl.h","+180").hex(),e.set("hsl.h","+270").hex()]};return(0,l.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,l.jsx)(c.A,{sx:{display:"flex",gap:2,justifyContent:"center"},children:t.map((e,t)=>(0,l.jsx)("div",{style:{width:32,height:32,backgroundColor:e,cursor:"pointer",border:"2px solid #999"},onClick:e=>x(e,t),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&x(e,t)}},"".concat(e+t)))}),(0,l.jsx)(s.A,{variant:"contained",color:"primary",onClick:()=>{g().forEach((e,l)=>{l<t.length&&n(l,e)})},children:"Randomize Palette"}),(0,l.jsx)(j.A,{anchorEl:r,open:!!r,onClose:p,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,l.jsx)(b.A,{disableRipple:!0,children:(0,l.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[(0,l.jsx)(y.jI,{color:h||"#ffffff",onChange:d}),(0,l.jsxs)(c.A,{sx:{display:"flex",gap:1,marginTop:1},children:[(0,l.jsx)(s.A,{variant:"contained",color:"success",size:"small",onClick:()=>{null!==a&&h&&n(a,h),p()},children:"Confirm"}),(0,l.jsx)(s.A,{variant:"contained",color:"error",size:"small",onClick:p,children:"Cancel"})]})]})})})]})}function C(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function k(e){return new Promise((t,n)=>{let l=new FileReader;l.onload=()=>{"string"==typeof l.result?t(l.result):n(Error("File reading error"))},l.onerror=()=>n(l.error),l.readAsDataURL(e)})}function A(e,t){let n={left:e.left,right:e.left+e.width,top:e.top,bottom:e.top+e.height},l={left:t.left,right:t.left+t.width,top:t.top,bottom:t.top+t.height};return!(n.right<=l.left||n.left>=l.right||n.bottom<=l.top||n.top>=l.bottom)}function D(e,t){let n=0,l=[...e];for(;n<500;){let e=!1;for(let n=0;n<l.length;n++)for(let o=n+1;o<l.length;o++){let r=l[n],i=l[o];if(A(r,i)){e=!0;let n=r.width*r.height<i.width*i.height?{x:1,y:0}:{x:0,y:1},a=function(e,t,n,l){let o=e,r=0;for(;t.some(e=>e.id!==o.id&&A(o,e))&&(o={...o,left:l(o.left+20*n.x),top:l(o.top+20*n.y)},!(++r>200)););return o}(i,l.filter((e,t)=>t!==o),n,t);l[o]=a}}if(!e)break;n++}return l}function P(e,t,n){let l={...e},o=0;for(;o<500&&t.some(e=>A(l,e));)l.top=n(l.top+20),o++;return l}var S=n(2111),M=n(507),z=n(7496),I=n(152);let _={small:{width:400,height:300},medium:{width:800,height:600},large:{width:1200,height:900}};function F(e){let{onChange:t}=e,[n,r]=(0,o.useState)("preset"),[i,a]=(0,o.useState)("medium"),[s,u]=(0,o.useState)(800),[h,d]=(0,o.useState)(600),x=e=>{a(e);let{width:n,height:l}=_[e];t(n,l)},p=(0,o.useCallback)(()=>{t(s,h)},[s,h,t]);return(0,l.jsxs)(c.A,{sx:{display:"flex",gap:2,alignItems:"center",mb:2},children:[(0,l.jsxs)(S.A,{children:[(0,l.jsx)(M.A,{children:"Mode"}),(0,l.jsxs)(z.A,{value:n,label:"Mode",onChange:e=>r(e.target.value),children:[(0,l.jsx)(b.A,{value:"preset",children:"Preset Sizes"}),(0,l.jsx)(b.A,{value:"custom",children:"Custom Dimensions"})]})]}),"preset"===n&&(0,l.jsxs)(S.A,{children:[(0,l.jsx)(M.A,{children:"Size"}),(0,l.jsxs)(z.A,{value:i,label:"Size",onChange:e=>x(e.target.value),children:[(0,l.jsx)(b.A,{value:"small",children:"Small (400x300)"}),(0,l.jsx)(b.A,{value:"medium",children:"Medium (800x600)"}),(0,l.jsx)(b.A,{value:"large",children:"Large (1200x900)"})]})]}),"custom"===n&&(0,l.jsxs)(c.A,{sx:{display:"flex",gap:1},children:[(0,l.jsx)(I.A,{label:"Width",type:"number",value:s,onChange:e=>u(parseInt(e.target.value,10)||0),onBlur:p}),(0,l.jsx)(I.A,{label:"Height",type:"number",value:h,onChange:e=>d(parseInt(e.target.value,10)||0),onBlur:p})]})]})}var E=n(78),R=n.n(E);function B(){let[e,t]=(0,o.useState)({width:800,height:600}),[n,x]=(0,o.useState)(!1),[p,j]=(0,o.useState)({x:0,y:0}),[b,y]=(0,o.useState)(null),v=(0,o.useRef)(null),[A,S]=(0,o.useState)(null),[M,z]=(0,o.useState)({x:0,y:0}),[I,_]=(0,o.useState)({x:0,y:0}),[E,B]=(0,o.useState)({w:0,h:0,top:0,left:0}),[X,Y]=(0,o.useState)([]),[L,N]=(0,o.useState)(null),[O,U]=(0,o.useState)(!0),[T,G]=(0,o.useState)(["#FF0000","#00FF00","#0000FF","#FFFF00"]),K=(0,o.useCallback)(()=>{v.current&&R()(v.current).then(e=>{let t=e.toDataURL("image/png"),n=document.createElement("a");n.download="mosaic.png",n.href=t,n.click()})},[v]),W=(0,o.useCallback)((e,t)=>{G(n=>{let l=[...n];return l[e]=t,l}),Y(n=>n.map(n=>n.paletteIndex===e?{...n,color:t}:n))},[]),H=(0,o.useCallback)(e=>O?20*Math.round(e/20):e,[O]),J=(0,o.useRef)(null),Z=async e=>{if(!e.target.files)return;let t=Array.from(e.target.files),n=[...X];for(let e of t){let t=await k(e),l=P({id:C(),type:"image",src:t,width:H(150+100*Math.random()),height:H(100+80*Math.random()),top:H(200*Math.random()),left:H(200*Math.random())},n,H);n.push(l),n=D(n,H)}Y(n)},q=(0,o.useCallback)(e=>{Y(t=>{let n=t.findIndex(t=>t.id===e);if(-1===n)return t;let l=t[n],o=[...t];return o.splice(n,1),o.push(l),o})},[]),Q=(0,o.useCallback)((e,t)=>{v.current&&(L||function(e,t,n,l,o){n(t),l(t);let r=e.currentTarget.getBoundingClientRect();o({x:e.clientX-r.left,y:e.clientY-r.top}),e.preventDefault(),e.stopPropagation()}(e,t,q,S,z))},[q,L]),V=(0,o.useCallback)(e=>{if(!v.current)return;let t=v.current.getBoundingClientRect();if(L){!function(e,t,n,l,o,r,i){if(!t)return;let{pieceId:a,edge:s}=t,c=e.clientX-n.x,u=e.clientY-n.y;i(e=>{let t=e.findIndex(e=>e.id===a);if(-1===t)return e;let n=e[t],i=n.left,h=n.top,d=n.width,x=n.height;switch(s){case"left":{let e=l.left+c,t=l.w-c;t>=30&&(i=r(e),d=r(t));break}case"right":{let e=l.w+c;e>=30&&(d=r(e));break}case"top":{let e=l.top+u,t=l.h-u;t>=30&&(h=r(e),x=r(t));break}case"bottom":{let e=l.h+u;e>=o&&(x=r(e));break}case"top-left":{let e=l.left+c,t=l.w-c,n=l.top+u,a=l.h-u;t>=o&&a>=o&&(i=r(e),d=r(t),h=r(n),x=r(a));break}case"top-right":{let e=l.top+u,t=l.h-u,n=l.w+c;n>=o&&t>=o&&(d=r(n),h=r(e),x=r(t));break}case"bottom-left":{let e=l.left+c,t=l.w-c,n=l.h+u;t>=o&&n>=o&&(i=r(e),d=r(t),x=r(n));break}case"bottom-right":{let e=l.w+c,t=l.h+u;e>=o&&t>=o&&(d=r(e),x=r(t))}}let p={...n,left:i,top:h,width:d,height:x},g=[...e];return g[t]=p,D(g,r)}),e.preventDefault()}(e,L,I,E,30,H,Y),e.preventDefault();return}A&&(A&&(Y(n=>{let l=n.findIndex(e=>e.id===A);if(-1===l)return n;let o=n[l],r=e.clientX-t.left-M.x,i=e.clientY-t.top-M.y,a={...o,left:H(r),top:H(i)},s=[...n];return s[l]=a,D(s,H)}),e.preventDefault()),e.preventDefault())},[L,A,M,I,E,H]),$=(0,o.useCallback)(()=>{A&&S(null),L&&N(null)},[A,L]),ee=(0,o.useCallback)((e,t,n)=>{v.current&&(A||L||function(e,t,n,l,o,r,i,a){l(t);let s=a.find(e=>e.id===t);s&&(o({pieceId:t,edge:n}),r({w:s.width,h:s.height,top:s.top,left:s.left}),i({x:e.clientX,y:e.clientY}),e.preventDefault(),e.stopPropagation())}(e,t,n,q,N,B,_,X))},[q,A,L,X]),et=(0,o.useCallback)((e,t)=>{e.preventDefault(),e.stopPropagation(),x(!0),j({x:e.clientX,y:e.clientY}),y(t)},[]),en=(0,o.useCallback)(e=>{e.target===v.current&&(e.preventDefault(),x(!1),y(null))},[]),el=(0,o.useCallback)(e=>{b&&(Y(t=>t.map(t=>t.id===b&&"color"===t.type?{...t,color:T[e],paletteIndex:e}:t)),x(!1))},[b,T]),eo=(0,o.useRef)(null),er=(0,o.useCallback)(()=>{eo.current&&(eo.current.value="",eo.current.click())},[]),ei=(0,o.useCallback)(async e=>{if(!e.target.files||!b)return;let t=e.target.files[0];if(!t)return;let n=await k(t);Y(e=>e.map(e=>e.id===b&&"image"===e.type?{...e,src:n}:e)),x(!1)},[b]),ea=(0,o.useCallback)(()=>{b&&(Y(e=>e.filter(e=>e.id!==b)),x(!1))},[b]),es=X.find(e=>e.id===b);return(0,l.jsxs)(r.A,{maxWidth:"lg",sx:{py:4,touchAction:"none"},children:[(0,l.jsx)("input",{ref:J,type:"file",multiple:!0,accept:"image/*",onChange:Z,style:{display:"none"}}),(0,l.jsx)("input",{ref:eo,type:"file",accept:"image/*",style:{display:"none"},onChange:ei}),(0,l.jsxs)(i.Ay,{container:!0,spacing:3,children:[(0,l.jsx)(i.Ay,{container:!0,justifyContent:"center",item:!0,xs:12,md:3,children:(0,l.jsxs)(a.A,{spacing:3,children:[(0,l.jsxs)(a.A,{direction:{xs:"row",md:"column"},spacing:2,children:[(0,l.jsx)(s.A,{variant:"contained",onClick:()=>{var e;return null===(e=J.current)||void 0===e?void 0:e.click()},children:"Upload Images"}),(0,l.jsx)(s.A,{variant:"contained",onClick:()=>{let e=[...X];for(let t=0;t<T.length;t++){let n=P({id:C(),type:"color",color:T[t],paletteIndex:t,width:H(60+60*Math.random()),height:H(60+60*Math.random()),top:H(200*Math.random()),left:H(200*Math.random())},e,H);e.push(n),e=D(e,H)}Y(e)},children:"Add Color Blocks"})]}),(0,l.jsx)(w,{colorPalette:T,onChangeColor:W}),(0,l.jsx)(s.A,{variant:"contained",onClick:K,children:"Export as Image"})]})}),(0,l.jsx)(i.Ay,{item:!0,xs:12,md:9,children:(0,l.jsxs)(a.A,{spacing:2,children:[(0,l.jsxs)(a.A,{direction:{xs:"column",sm:"row"},alignItems:"center",spacing:2,children:[(0,l.jsx)(c.A,{children:(0,l.jsx)(F,{onChange:(e,n)=>{t({width:e,height:n})}})}),(0,l.jsx)(u.A,{control:(0,l.jsx)(h.A,{checked:O,onChange:()=>U(e=>!e),color:"primary"}),label:O?"Snap to Grid":"Enable Snap"})]}),(0,l.jsx)(d.A,{elevation:3,sx:{width:e.width,height:e.height,position:"relative",margin:"0 auto",p:1},children:(0,l.jsx)("div",{className:g().mosaicContainer,ref:v,style:{width:"100%",height:"100%",position:"relative"},onPointerMove:V,onPointerUp:$,onContextMenu:en,children:X.map(e=>{let t="color"===e.type&&void 0!==e.paletteIndex?T[e.paletteIndex]:e.color;return(0,l.jsx)(f,{piece:{...e,color:t},onPointerDown:Q,onContextMenu:et,onResizeEdgePointerDown:ee},e.id)})})})]})})]}),(0,l.jsx)(m,{open:n&&!!es,position:p,piece:es||null,colorPalette:T,onChangeColorIndex:el,onChangeImageClick:er,onDeletePiece:ea,closeMenu:()=>x(!1)})]})}function X(){return(0,l.jsx)(B,{})}},8334:e=>{e.exports={mosaicContainer:"page_mosaicContainer__MFJyf",mosaicPiece:"page_mosaicPiece__gjvKX",colorBlock:"page_colorBlock__YmY0Z",controls:"page_controls__MGrPX"}}},e=>{var t=t=>e(e.s=t);e.O(0,[397,316,412,441,517,358],()=>t(738)),_N_E=e.O()}]);